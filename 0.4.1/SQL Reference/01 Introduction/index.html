
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>SQL Introduction - Opteryx</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,400,400i,700%7CJetBrains+Mono&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sql-introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Opteryx" class="md-header__button md-logo" aria-label="Opteryx" data-md-component="logo">
      
  <img src="../../icarus-opteryx.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Opteryx
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SQL Introduction
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mabel-dev/opteryx/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Opteryx" class="md-nav__button md-logo" aria-label="Opteryx" data-md-component="logo">
      
  <img src="../../icarus-opteryx.png" alt="logo">

    </a>
    Opteryx
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mabel-dev/opteryx/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../02%20Getting%20Started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../03%20Client%20Connectivity/" class="md-nav__link">
        Clients
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Contributor Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributor Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Contributor Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributor%20Guide/01%20Guide/" class="md-nav__link">
        Contributor Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributor%20Guide/02%20Code%20of%20Conduct/" class="md-nav__link">
        Code of Conduct
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributor%20Guide/03%20Etiquette/" class="md-nav__link">
        Community Etiquette
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributor%20Guide/90%20Debian%20%28Ubuntu%29/" class="md-nav__link">
        Set Up Guide (Debian/Ubuntu)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributor%20Guide/90%20MacOS/" class="md-nav__link">
        Set Up Guide (MacOS)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributor%20Guide/90%20Windows/" class="md-nav__link">
        Set Up Guide (Windows)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Contributor%20Guide/95%20Project%20Structure/" class="md-nav__link">
        Project Structure
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Deployment" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Deployment
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Deployment/00%20Deployment%20Guide/" class="md-nav__link">
        Deployment Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Deployment/10%20Storage/" class="md-nav__link">
        Data Storage
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Deployment/20%20Hosting/" class="md-nav__link">
        Hosting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Deployment/30%20Advanced/" class="md-nav__link">
        Advanced Set Up
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_5" type="checkbox" id="__nav_5_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_5">
          Internals
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Internals" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_5">
          <span class="md-nav__icon md-icon"></span>
          Internals
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Deployment/Internals/Query%20Engine/" class="md-nav__link">
        Query Engine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Deployment/Internals/Storage%20Engine/" class="md-nav__link">
        Storage Formats
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Features" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Features/Command%20Line/" class="md-nav__link">
        Command Line Interface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Features/Multi%20Platform/" class="md-nav__link">
        Multi Platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Features/Schema%20Evolution/" class="md-nav__link">
        Schema Evolution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Features/Time%20Travel/" class="md-nav__link">
        Time Travel
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Release Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Release Notes" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Release Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release%20Notes/Change%20Log/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release%20Notes/Notices/" class="md-nav__link">
        Notices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Release%20Notes/Version%20Goals/" class="md-nav__link">
        Version Goals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          SQL Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="SQL Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          SQL Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          SQL Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        SQL Introduction
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    Concepts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-relations" class="md-nav__link">
    Querying Relations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joins-between-relations" class="md-nav__link">
    Joins Between Relations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aggregate-functions" class="md-nav__link">
    Aggregate Functions
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../02%20Statements/" class="md-nav__link">
        Statements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../04%20Data%20Types/" class="md-nav__link">
        Data Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../05%20Expressions/" class="md-nav__link">
        Expressions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../06%20Functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../07%20Aggregates/" class="md-nav__link">
        Aggregates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../08%20Joins/" class="md-nav__link">
        Joins
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../09%20Temporality/" class="md-nav__link">
        Temporality
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../10%20Sample%20Data/" class="md-nav__link">
        Sample Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8_10" type="checkbox" id="__nav_8_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8_10">
          Working with SQL
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Working with SQL" data-md-level="2">
        <label class="md-nav__title" for="__nav_8_10">
          <span class="md-nav__icon md-icon"></span>
          Working with SQL
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Working%20with%20SQL/10%20Working%20with%20Timestamps/" class="md-nav__link">
        Working with Timestamps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Working%20with%20SQL/20%20Working%20with%20Lists/" class="md-nav__link">
        Working with Lists
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Working%20with%20SQL/30%20Working%20with%20Structs/" class="md-nav__link">
        Working with Structs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Working%20with%20SQL/40%20Access%20Historical%20Data/" class="md-nav__link">
        Accessing Historical Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Working%20with%20SQL/50%20Relation%20Constructors/" class="md-nav__link">
        Relation Constructors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Working%20with%20SQL/70%20Advanced/" class="md-nav__link">
        Advanced
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Working%20with%20SQL/99%20Query%20Optimization/" class="md-nav__link">
        Query Optimization
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#concepts" class="md-nav__link">
    Concepts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-relations" class="md-nav__link">
    Querying Relations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#joins-between-relations" class="md-nav__link">
    Joins Between Relations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aggregate-functions" class="md-nav__link">
    Aggregate Functions
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/mabel-dev/opteryx/edit/master/docs/SQL Reference/01 Introduction.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="sql-introduction">SQL Introduction</h1>
<h2 id="overview">Overview</h2>
<p>This page provides an overview of how to perform simple operations in SQL. This tutorial is only intended to give you an introduction and is not a complete tutorial on SQL. This tutorial is reworked from the <a href="https://duckdb.org/docs/sql/introduction">DuckDB</a> tutorial.</p>
<p>All queries use the internal sample NASA datasets and should work regardless of the data your installation and set up has access to.</p>
<h2 id="concepts">Concepts</h2>
<p><a href="https://github.com/mabel-dev/opteryx">Opteryx</a> is a system for querying ad hoc data stored in files as <a href="https://en.wikipedia.org/wiki/Relation_(database)">relations</a>. A relation is mathematical term for a data table.</p>
<p>Each relation is a named collection of rows, organized in columns, each column should be a common datatype. </p>
<p>As an ad hoc query engine, the relations and their schema do not need to be predefined, they are determined at the time the query is run. This is one of the reasons Opteryx cannot be considered a RDBMS (relational database management system), even though it can be used to query data using SQL.</p>
<h2 id="querying-relations">Querying Relations</h2>
<p>To retrieve data from a relation, the relation is queried using a SQL <code>SELECT</code> statement. Basic statements are made of three parts; the list of columns to be returned and the list of relations to retrieve data from, and optional clauses to shape and filter the data that is returned.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="__codelineno-0-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="__codelineno-0-2"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The <code>*</code> is shorthand for "all columns", by convention keywords are capitalized, and <code>;</code> optionally terminates the query.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="__codelineno-1-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="__codelineno-1-2"></a><span class="w">       </span><span class="n">name</span><span class="w"></span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="__codelineno-1-3"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="w"></span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="__codelineno-1-4"></a><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Earth&#39;</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The output of the above query should be </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="__codelineno-2-1"></a> id |  name
<a id="__codelineno-2-2" name="__codelineno-2-2" href="__codelineno-2-2"></a>----+-------
<a id="__codelineno-2-3" name="__codelineno-2-3" href="__codelineno-2-3"></a>  3 | Earth
</code></pre></div>
<p>You can write functions, not just simple column references, in the select list. For example, you can write:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="__codelineno-3-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="__codelineno-3-2"></a><span class="w">       </span><span class="k">UPPER</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">uppercase_name</span><span class="w"></span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="__codelineno-3-3"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="w"></span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="__codelineno-3-4"></a><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>This should give:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="__codelineno-4-1"></a> id | uppercase_name
<a id="__codelineno-4-2" name="__codelineno-4-2" href="__codelineno-4-2"></a>----+----------------
<a id="__codelineno-4-3" name="__codelineno-4-3" href="__codelineno-4-3"></a>  3 | EARTH
</code></pre></div>
<p>Notice how the <code>AS</code> clause is used to relabel the output column. (The <code>AS</code> clause is optional.)</p>
<p>A query can be “qualified” by adding a <code>WHERE</code> clause that specifies which rows are wanted. The <code>WHERE</code> clause contains a Boolean (truth value) expression, and only rows for which the Boolean expression is true are returned. The usual Boolean operators (<code>AND</code>, <code>OR</code>, and <code>NOT</code>) are allowed in the qualification. </p>
<p>The <code>SELECT</code> clause can be thought of as choosing which columns we want from the relation, and the <code>WHERE</code> clause as choosing which rows we want from the relation.</p>
<p><img alt="WHERE and SELECT" src="../select-project.svg" /></p>
<p>For example, the following the planets with fewer than 10 moons and a day longer than 24 hours:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="__codelineno-5-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="__codelineno-5-2"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="w"></span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="__codelineno-5-3"></a><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">lengthOfDay</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">24</span><span class="w"></span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="__codelineno-5-4"></a><span class="w">   </span><span class="k">AND</span><span class="w"> </span><span class="n">numberOfMoons</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Result:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="__codelineno-6-1"></a>name    | lengthOfDay | numberOfMoons
<a id="__codelineno-6-2" name="__codelineno-6-2" href="__codelineno-6-2"></a>--------+-------------+---------------
<a id="__codelineno-6-3" name="__codelineno-6-3" href="__codelineno-6-3"></a>Mercury |      4222.6 |             0
<a id="__codelineno-6-4" name="__codelineno-6-4" href="__codelineno-6-4"></a>Venus   |        2802 |             0
<a id="__codelineno-6-5" name="__codelineno-6-5" href="__codelineno-6-5"></a>Mars    |        24.7 |             2
<a id="__codelineno-6-6" name="__codelineno-6-6" href="__codelineno-6-6"></a>Pluto   |       153.3 |             5
</code></pre></div>
<p>The order of results are not guaranteed and should not be relied upon. If you request the results of the below query, you might get the Mercury or Venus in either order. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The same query, of the same data in the same version of Opteryx will likely to return results in the same order, don't expect to test result order non-determinism by rerunning the query millions of times and looking for differences. These differences may manifest over different versions, or from subtle differences to the query statement or data.</p>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="__codelineno-7-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="__codelineno-7-2"></a><span class="w">       </span><span class="n">numberOfMoons</span><span class="w"></span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="__codelineno-7-3"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="w"></span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="__codelineno-7-4"></a><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">numberOfMoons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Result:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="__codelineno-8-1"></a>name    | lengthOfDay | numberOfMoons
<a id="__codelineno-8-2" name="__codelineno-8-2" href="__codelineno-8-2"></a>--------+-------------+---------------
<a id="__codelineno-8-3" name="__codelineno-8-3" href="__codelineno-8-3"></a>Mercury |      4222.6 |             0
<a id="__codelineno-8-4" name="__codelineno-8-4" href="__codelineno-8-4"></a>Venus   |        2802 |             0
</code></pre></div>
<p>But you’d always get the results shown above if you do:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="__codelineno-9-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"></span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="__codelineno-9-2"></a><span class="w">       </span><span class="n">numberOfMoons</span><span class="w"></span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="__codelineno-9-3"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="w"></span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="__codelineno-9-4"></a><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">numberOfMoons</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="__codelineno-9-5"></a><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">name</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>You can request that duplicate rows be removed from the result of a query:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="__codelineno-10-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">planetId</span><span class="w"></span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="__codelineno-10-2"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">satellites</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Result:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="__codelineno-11-1"></a>planetId
<a id="__codelineno-11-2" name="__codelineno-11-2" href="__codelineno-11-2"></a>--------
<a id="__codelineno-11-3" name="__codelineno-11-3" href="__codelineno-11-3"></a>       3
<a id="__codelineno-11-4" name="__codelineno-11-4" href="__codelineno-11-4"></a>       4
<a id="__codelineno-11-5" name="__codelineno-11-5" href="__codelineno-11-5"></a>       5
<a id="__codelineno-11-6" name="__codelineno-11-6" href="__codelineno-11-6"></a>       6
<a id="__codelineno-11-7" name="__codelineno-11-7" href="__codelineno-11-7"></a>       7
<a id="__codelineno-11-8" name="__codelineno-11-8" href="__codelineno-11-8"></a>       8
<a id="__codelineno-11-9" name="__codelineno-11-9" href="__codelineno-11-9"></a>       9
</code></pre></div>
<p>Here again, the result row ordering might vary. You can ensure consistent results by using <code>DISTINCT</code> and <code>ORDER BY</code> together:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="__codelineno-12-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">planetId</span><span class="w"></span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="__codelineno-12-2"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">satellites</span><span class="w"></span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="__codelineno-12-3"></a><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">planetId</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<h2 id="joins-between-relations">Joins Between Relations</h2>
<p>So far our queries have only accessed one relation at a time. Queries can access multiple relations at once, or access the same relation in such a way that multiple rows of the relation are being processed at the same time. A query that accesses multiple rows of the same or different relations at one time is called a join query. </p>
<p>As an example, say you wish to list all the <em>$satellites</em> records together with the planet they orbit. To do that, we need to compare the <em>planetId</em> of each row of the <em>$satellites</em> relation with the <em>id</em> column of all rows in the <em>$planets</em> relation, and return the pairs of rows where these values match.</p>
<p>This would be accomplished by the following query:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="__codelineno-13-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="__codelineno-13-2"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">satellites</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="w"></span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="__codelineno-13-3"></a><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">planetId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="__codelineno-14-1"></a>$satellites.id | planetId | $satellites.name | ...
<a id="__codelineno-14-2" name="__codelineno-14-2" href="__codelineno-14-2"></a>---------------+----------+------------------+----
<a id="__codelineno-14-3" name="__codelineno-14-3" href="__codelineno-14-3"></a>             1 |        3 | Moon             |
<a id="__codelineno-14-4" name="__codelineno-14-4" href="__codelineno-14-4"></a>             2 |        4 | Phobos           |
<a id="__codelineno-14-5" name="__codelineno-14-5" href="__codelineno-14-5"></a>             3 |        4 | Deimos           |
<a id="__codelineno-14-6" name="__codelineno-14-6" href="__codelineno-14-6"></a>             4 |        5 | Io               |
<a id="__codelineno-14-7" name="__codelineno-14-7" href="__codelineno-14-7"></a>             5 |        5 | Europa           |
<a id="__codelineno-14-8" name="__codelineno-14-8" href="__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="__codelineno-14-9"></a>(more rows and columns)
</code></pre></div>
<p>Observe two things about the result set:</p>
<p>There are no result row for the planets of Mercury or Venus (<em>planetIds</em> 1 and 2). This is because there is no matching entry in the <em>$satellites</em> relation for these planets, so the join ignores the unmatched rows in the <em>$planets</em> relation.</p>
<p>Each of the relations being joined have an <em>id</em> and a <em>name</em> column, to ensure it is clear which relation the value being displayed is from, columns with clashing names are qualified with the relation name.</p>
<p>To avoid abiguity and problems in the future if new columns are added to relations, it is good practice to qualify column names in join conditions:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="__codelineno-15-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="__codelineno-15-2"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">satellites</span><span class="p">,</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="w"></span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="__codelineno-15-3"></a><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="err">$</span><span class="n">satellites</span><span class="p">.</span><span class="n">planetId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>Will return the same result as above, but be more resistant to future failure.</p>
<p>Join queries of the kind seen thus far can also be written in this alternative form:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="__codelineno-16-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="__codelineno-16-2"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">satellites</span><span class="w"> </span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="__codelineno-16-3"></a><span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="w"> </span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="__codelineno-16-4"></a><span class="w">         </span><span class="k">ON</span><span class="w"> </span><span class="err">$</span><span class="n">satellites</span><span class="p">.</span><span class="n">planetId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<p>The Opteryx planner currently uses a different execution strategy for these two similar queries, the explicit <code>INNER JOIN</code> style generally executes faster.</p>
<p>Now we will figure out how we can get the Mercury and Venus records back in. What we want the query to do is to scan the <em>$planets</em> relation and for each row to find the matching <em>$satellites</em> row(s). If no matching row is found we want some “empty values” to be substituted for the <em>$satellites</em> relations columns. This kind of query is called an outer join. (The joins we have seen so far are inner joins and cross joins.) The command looks like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="__codelineno-17-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="__codelineno-17-2"></a><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="err">$</span><span class="n">satellites</span><span class="w"> </span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="__codelineno-17-3"></a><span class="w"> </span><span class="k">LEFT</span><span class="w"> </span><span class="k">OUTER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="w"> </span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="__codelineno-17-4"></a><span class="w">         </span><span class="k">ON</span><span class="w"> </span><span class="err">$</span><span class="n">satellites</span><span class="p">.</span><span class="n">planetId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="n">planets</span><span class="p">.</span><span class="n">id</span><span class="p">;</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="__codelineno-18-1"></a>$satellites.id | planetId | $satellites.name | ...
<a id="__codelineno-18-2" name="__codelineno-18-2" href="__codelineno-18-2"></a>---------------+----------+------------------+----
<a id="__codelineno-18-3" name="__codelineno-18-3" href="__codelineno-18-3"></a>               |        1 |                  |
<a id="__codelineno-18-4" name="__codelineno-18-4" href="__codelineno-18-4"></a>               |        2 |                  |
<a id="__codelineno-18-5" name="__codelineno-18-5" href="__codelineno-18-5"></a>             1 |        3 | Moon             |
<a id="__codelineno-18-6" name="__codelineno-18-6" href="__codelineno-18-6"></a>             2 |        4 | Phobos           |
<a id="__codelineno-18-7" name="__codelineno-18-7" href="__codelineno-18-7"></a>             3 |        4 | Deimos           |
<a id="__codelineno-18-8" name="__codelineno-18-8" href="__codelineno-18-8"></a>             4 |        5 | Io               |
<a id="__codelineno-18-9" name="__codelineno-18-9" href="__codelineno-18-9"></a>             5 |        5 | Europa           |
<a id="__codelineno-18-10" name="__codelineno-18-10" href="__codelineno-18-10"></a>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="__codelineno-18-11"></a>(more rows and columns)
</code></pre></div>
<p>Using the <code>LEFT OUTER JOIN</code> will mean the relation mentioned on the left of the join operator will have each of its rows in the output at least once, whereas the relation on the right will only have those rows output that match some row of the left relation. When outputting a left-relation row for which there is no right-relation match, empty (null) values are substituted for the right-relation columns. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>How null values are displayed may be different between different systems, common approaches are to display an empty cell or display 'none' or 'null' in an alternate format (e.g. italics or different font color). This is not controlled by Opteryx.</p>
</div>
<h2 id="aggregate-functions">Aggregate Functions</h2>
<p>Like most query engines and databases, Opteryx supports aggregate functions. An aggregate function computes a single result from multiple input rows. For example, there are aggregates to compute the <code>COUNT</code>, <code>SUM</code>, <code>AVG</code> (average), <code>MAX</code> (maximum) and <code>MIN</code> (minimum) over a set of rows.</p>
<!---
As an example, we can find the highest low-temperature reading anywhere with:

SELECT max(temp_lo) FROM weather;
 max
-----
  46
(1 row)
If we wanted to know what city (or cities) that reading occurred in, we might try:

SELECT city FROM weather WHERE temp_lo = max(temp_lo);     -- WRONG
but this will not work since the aggregate max cannot be used in the WHERE clause. (This restriction exists because the WHERE clause determines which rows will be included in the aggregate calculation; so obviously it has to be evaluated before aggregate functions are computed.) However, as is often the case the query can be restated to accomplish the desired result, here by using a subquery:

SELECT city FROM weather
    WHERE temp_lo = (SELECT max(temp_lo) FROM weather);
     city
---------------
 San Francisco
(1 row)
This is OK because the subquery is an independent computation that computes its own aggregate separately from what is happening in the outer query.

Aggregates are also very useful in combination with GROUP BY clauses. For example, we can get the maximum low temperature observed in each city with:

SELECT city, max(temp_lo)
    FROM weather
    GROUP BY city;
     city      | max
---------------+-----
 Hayward       |  37
 San Francisco |  46
(2 rows)
Which gives us one output row per city. Each aggregate result is computed over the table rows matching that city. We can filter these grouped rows using HAVING:

SELECT city, max(temp_lo)
    FROM weather
    GROUP BY city
    HAVING max(temp_lo) < 40;
  city   | max
---------+-----
 Hayward |  37
(1 row)
which gives us the same results for only the cities that have all temp_lo values below 40. Finally, if we only care about cities whose names begin with “S”, we can use the LIKE operator:

SELECT city, max(temp_lo)
    FROM weather
    WHERE city LIKE 'S%'            -- (1)
    GROUP BY city
    HAVING max(temp_lo) < 40;
More information about the LIKE operator can be found here.

It is important to understand the interaction between aggregates and SQL’s WHERE and HAVING clauses. The fundamental difference between WHERE and HAVING is this: WHERE selects input rows before groups and aggregates are computed (thus, it controls which rows go into the aggregate computation), whereas HAVING selects group rows after groups and aggregates are computed. Thus, the WHERE clause must not contain aggregate functions; it makes no sense to try to use an aggregate to determine which rows will be inputs to the aggregates. On the other hand, the HAVING clause always contains aggregate functions.

In the previous example, we can apply the city name restriction in WHERE, since it needs no aggregate. This is more efficient than adding the restriction to HAVING, because we avoid doing the grouping and aggregate calculations for all rows that fail the WHERE check.
--->

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../Release%20Notes/Version%20Goals/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Version Goals" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Version Goals
            </div>
          </div>
        </a>
      
      
        
        <a href="../02%20Statements/" class="md-footer__link md-footer__link--next" aria-label="Next: Statements" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Statements
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>